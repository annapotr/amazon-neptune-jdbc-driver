<!DOCTYPE html>
<html>
<head>
    <style>
        * {
            font-family: arial, sans-serif;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            height: 100px;
            overflow: auto;
        }

        td, th {
            position: sticky;
            border: 1px solid black;
            text-align: left;
            padding: 2px 8px 2px 8px;
        }

        tr {
            border: 1px lightgrey;
        }

        body {
            color: #333;
        }

        .result div {
            border: 1px solid #333;
        }

        .stable {
            /* Increasing the max-height will increase the view
            (in terms of height) for the findings Table.*/
            max-height: 400px;
            overflow: auto;
        }

        .date {
            text-align: right;
        }

        #about-dialog-text-area {
            width: 200px;
            border: 1px solid gray;
            margin: 0;
        }

        input {
            margin-bottom: 5px;
            padding: 2px 3px;
            width: 209px;
        }

        tr.hover {
            background-color: darkgrey;
        }

        tr.click-row {
            font-weight: bold;
        }

        .header h1 {
            display: inline;
        }

        .header span {
            float: right;
        }

        p {
            margin-top: 0;
            margin-bottom: 0;
        }

        ul {
            margin-top: 0;
            margin-bottom: 0;
            padding-left: 10px;
        }

        #summaryTable {
            border-collapse: separate;
        }

        /* Table sorting */
        table.tablesorter thead tr th, table.tablesorter tfoot tr th {
            border: 1px solid black;
        }

        table.tablesorter th.tablesorter-headerUnSorted::after {
            content: '↕️';
            align-content: right;
            cursor: pointer;
            display: block;
            position: absolute;
            right: 5px;
            top: 2px;
        }

        table.tablesorter th.tablesorter-headerAsc::after {
            content: '⬇️';
            color: darkgrey;
            display: block;
            position: absolute;
            right: 5px;
            top: 2px;
        }

        table.tablesorter th.tablesorter-headerDesc::after {
            content: '⬆️';
            color: darkgrey;
            display: block;
            position: absolute;
            right: 5px;
            top: 2px;
        }

        table.tablesorter th.tablesorter-headerAsc,
        table.tablesorter th.tablesorter-headerDesc {
            text-decoration: underline;
            color: dimgrey;
        }

        table.tablesorter th.headerSortDown,
        table.tablesorter th.headerSortUp {
            background-color: #8dbdd8;
        }

    </style>
</head>

<body>

<table id="summaryTable">
    <tr><br>
        <div class="header"><h1>Summary</h1>    <span class="date">Date: 2021-10-05</span></div>
        <br>
    </tr>

    <!--
        <tr id="about-dialog-text-area">
            <td colspan="2">
            </td>
        </tr>
    -->

    <tr>
        <td id="about-dialog-text-area">
                <p>Rules executed: 111</p>
                <p>Rules skipped: 0</p>
                <p>Total Findings: 0</p>
                <p>Unique Vulnerabilities found: 0</p>
                <p>Critical-Significance findings: 0</p>
                <p>High-Significance findings: 0</p>
                <p>Medium-Significance findings: 0</p>
                <p>Low-Significance findings: 0</p>
                <p>Ignored findings (blocked by finding or rule filters): 0</p>
        </td>

        <td valign="top" id="about-dialog-text-area">
            <h3>Analyzers used for scan</h3>
            <ul>
                    <li><p>Bosco: SUCCESS, 0 findings, <a href="bosco_metadata.html"
                                                                                         target="iframe">view analysis
                        metadata</a></p></li>
                    <li><p>orangeboxconfiguration: SUCCESS, 0 findings, <a href="orangeboxconfiguration_metadata.html"
                                                                                         target="iframe">view analysis
                        metadata</a></p></li>
                    <li><p>RetireJs: SUCCESS, 0 findings, <a href="retirejs_metadata.html"
                                                                                         target="iframe">view analysis
                        metadata</a></p></li>
                    <li><p>CoralCop: SKIPPED, 0 findings, <a href="coralcop_metadata.html"
                                                                                         target="iframe">view analysis
                        metadata</a></p></li>
                    <li><p>Cfnlint: SUCCESS, 0 findings, <a href="cfnlint_metadata.html"
                                                                                         target="iframe">view analysis
                        metadata</a></p></li>
                    <li><p>Guru: SUCCESS, 0 findings, <a href="guru_metadata.html"
                                                                                         target="iframe">view analysis
                        metadata</a></p></li>
                    <li><p>HostnameTypoDetection: SUCCESS, 0 findings, <a href="hostnametypodetection_metadata.html"
                                                                                         target="iframe">view analysis
                        metadata</a></p></li>
                    <li><p>Bandit: SUCCESS, 0 findings, <a href="bandit_metadata.html"
                                                                                         target="iframe">view analysis
                        metadata</a></p></li>
                    <li><p>documentation: SUCCESS, 0 findings, <a href="documentation_metadata.html"
                                                                                         target="iframe">view analysis
                        metadata</a></p></li>
            </ul>
        </td>
    </tr>
</table>
<br>
<div class="header">
    <h1>Findings</h1><span>Search: <input type="text" id="search" placeholder="Type to search findings"><button
        onclick="history.go(0)">X</button></span>
</div>
<br>
<div class="stable">
    <table id="table" class="table table-bordered table-striped">
        <thead>
        <tr>
            <th>Vulnerability</th>
            <th>Significance</th>
            <th>Confidence</th>
            <th>Location</th>
            <th>Analyzer</th>
            <th>Details</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<br>
<div class="header">
    <h1>Ignored Findings</h1>
</div>
<br>
<div class="stable">
    <table id="table" class="table table-bordered table-striped">
        <thead>
        <tr>
            <th>Vulnerability</th>
            <th>Significance</th>
            <th>Confidence</th>
            <th>Location</th>
            <th>Analyzer</th>
            <th>Details</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<br>
<div class="header">
    <h1>Rule Filter Configuration</h1>
</div>
<br>
<div class="stable">
    <table id="table" class="table table-bordered table-striped">
        <thead>
        <tr>
            <th>Ignored Rule IDs</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<br>
<div class="header">
    <h1>Findings Filter Configuration</h1>
</div>
<br>
<div class="stable">
    <table id="table" class="table table-bordered table-striped">
        <thead>
        <tr>
            <th>Fingerprint Versions</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>
<br>

<hr>
<br>
<iframe height="700px" width="100%" src="frame_default.html" id="iframe" name="iframe" scrolling="yes"></iframe>

<script src="https://m.media-amazon.com/images/G/01/oneg/assets/3.2.6/js/jquery.js"></script>
<script src="https://m.media-amazon.com/images/G/01/oneg/assets/3.2.6/js/jquery.tablesorter.js"></script>
<script type="text/javascript">
    function getTableRows() {
        return $('#table tbody tr');
    }

    function searchBoxKeyup() {
        var searchInput = $(this).val();
        getTableRows().hide().filter(function () {
            return searchRowFilter(searchInput, $(this).text());
        }).show();
    }

    /* Checking that all words in the input have a match in the text */
    function searchRowFilter(searchInput, text) {
        var trimmedInput = $.trim(searchInput);
        var normalizedInput = normalizeSearchText(trimmedInput).split(' ');
        var normalizedText = normalizeSearchText(text);
        var matchesSearch = true;
        $(normalizedInput).each(function (index, value) {
            matchesSearch = (!matchesSearch) ? false : ~normalizedText.indexOf(value);
        });
        return matchesSearch;
    }

    function normalizeSearchText(text) {
        return text.replace(/ +/g, ' ').toLowerCase();
    }

    function rowClick() {
        var url = $(this).find('a').attr('href');
        $('#iframe').attr('src', url);
        getTableRows().not(this).removeClass('click-row');
        $(this).addClass('click-row');
    }

    function rowHoverIn() {
        $(this).addClass('hover');
    }

    function rowHoverOut() {
        $(this).removeClass('hover');
    }

    function formatSignificanceValue(s) {
        return s.toLowerCase()
                .replace("CRITICAL", "a")
                .replace("HIGH", "b")
                .replace("MEDIUM", "c")
                .replace("LOW", "d");
    }

    function getTableSorterSignificanceParser() {
        return {
            id: 'significance',
            is: function (s) {
                return false;
            },
            format: formatSignificanceValue,
            type: 'text'
        };
    }

    function configureTableSorter() {
        $.tablesorter.addParser(getTableSorterSignificanceParser());
        var significanceColumnIndex = $('th:contains("Significance")').index();
        $('#table').tablesorter({
            headerTemplate: "{content}{icon}",
            sortInitialOrder: "asc",
            sortList: [[significanceColumnIndex, 0]],
            sortRestart: true,
            headers: {
                2: {
                    sorter: 'significance',
                    sortInitialOrder: 'asc'
                },
                5: {sorter: false}
            }
        });
    }

    $(document).ready(function () {
        $('#search').keyup(searchBoxKeyup);
        getTableRows().hover(rowHoverIn, rowHoverOut).click(rowClick);
        configureTableSorter();
    });

</script>

</body>
</html>